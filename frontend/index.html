<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>Linus 九宮格洞察板</title>
    <link rel="icon" href="data:," />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="app-header">
      <div>
        <h1>九宮格洞察板</h1>
        <p>打開即懂本日重點，點擊即查原始段落。</p>
      </div>
      <div class="search-container">
        <input
          type="search"
          id="searchInput"
          placeholder="搜尋關鍵字、來源或狀態..."
        />
        <select id="gridFilter">
          <option value="">全部格子</option>
        </select>
        <select id="statusFilter">
          <option value="">所有狀態</option>
          <option value="new_entry">本次新增</option>
          <option value="needs_review">需覆核</option>
          <option value="merged">已合併</option>
        </select>
      </div>
    </header>

    <section class="segment-form">
      <div>
        <h2>貼入逐字稿</h2>
        <p>一次貼多段文字（以空白行分段），系統會自動分類到九宮格。</p>
      </div>
      <form id="segmentForm">
        <div class="form-row">
          <label>
            來源 / 標籤
            <input type="text" id="segmentSource" placeholder="例如：meeting-2024-09-20" />
          </label>
        </div>
        <div class="form-row">
          <label>
            逐字稿內容
            <textarea id="segmentText" rows="4" placeholder="貼上逐字稿，空白行分段..."></textarea>
          </label>
        </div>
        <div class="form-actions">
          <span id="segmentStatus"></span>
          <button type="submit" id="segmentSubmit">送出並分類</button>
        </div>
        <div class="toast-stack" id="toastStack"></div>
      </form>
      <div class="ingest-results hidden" id="ingestResults">
        <h3>這次貼文整理結果</h3>
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>段落片段</th>
              <th>主格</th>
              <th>狀態</th>
              <th>說明</th>
              <th>分類器</th>
              <th>錯誤訊息</th>
            </tr>
          </thead>
          <tbody id="ingestTableBody"></tbody>
        </table>
      </div>
    </section>

    <main class="app-body">
      <section class="mandala-column">
        <div class="mandala-controls">
          <button id="backButton" disabled>回上一層</button>
          <div class="breadcrumb" id="mandalaBreadcrumb">⑤ 中心：SKiDIY 核心目標</div>
          <div class="view-toggle">
            <label><input type="radio" name="viewMode" value="single" checked /> 單宮模式</label>
            <label><input type="radio" name="viewMode" value="overview" /> 9×9 總覽</label>
          </div>
        </div>
        <section class="grid-board" id="gridBoard"></section>
        <section class="grid-board overview hidden" id="overviewBoard"></section>
      </section>
      <aside class="detail-panel" id="detailPanel">
        <div class="placeholder">
          <h2>選擇中心或外圈格</h2>
          <p>點擊曼陀羅任一格即可展開 summary、來源與 needs review。</p>
        </div>
      </aside>
    </main>

    <section class="search-results" id="searchResults">
      <header>
        <h3>搜尋結果</h3>
        <span id="resultCount"></span>
      </header>
      <ul id="resultsList"></ul>
    </section>

    <template id="gridCardTemplate">
      <article class="grid-card">
        <span class="grid-id"></span>
        <h2 class="grid-title"></h2>
        <p class="grid-detail"></p>
        <small class="grid-note"></small>
      </article>
    </template>

    <template id="entryTemplate">
      <li class="entry">
        <div>
          <p class="snippet"></p>
          <small class="meta"></small>
        </div>
        <button class="action-view-log">查看 Log</button>
      </li>
    </template>

    <div class="modal" id="logModal">
      <div class="modal-content">
        <header>
          <h3>Insight Log</h3>
          <button id="closeModal">×</button>
        </header>
        <ul id="logList"></ul>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
